<?xml version="1.0" encoding="utf-8"?>
<templates xml:space="preserve">

    <t t-name="garment_mobile.MobileDashboard">
        <div class="garment-mobile-dashboard">

            <!-- Header -->
            <div class="gmd-header">
                <h2>üìä B·∫£ng ƒêi·ªÅu Khi·ªÉn</h2>
                <button class="gmd-refresh-btn"
                        t-att-class="{ spinning: state.loading }"
                        t-on-click="onRefresh"
                        title="T·∫£i l·∫°i">
                    üîÑ
                </button>
            </div>

            <!-- Loading -->
            <div t-if="state.loading" class="gmd-empty">
                ‚è≥ ƒêang t·∫£i d·ªØ li·ªáu...
            </div>

            <div t-if="!state.loading">

                <!-- KPI Cards -->
                <div class="gmd-kpi-grid">
                    <div class="gmd-kpi-card kpi-primary"
                         t-on-click="() => this.openAction('garment_base.action_garment_order')">
                        <div class="kpi-label">T·ªïng ƒê∆°n H√†ng</div>
                        <div class="kpi-number" t-out="state.data.order.total"/>
                        <div class="kpi-sub">
                            <t t-out="state.data.order.done"/> ho√†n th√†nh
                        </div>
                    </div>

                    <div class="gmd-kpi-card kpi-info"
                         t-on-click="() => this.openAction('garment_base.action_garment_order')">
                        <div class="kpi-label">ƒêang S·∫£n Xu·∫•t</div>
                        <div class="kpi-number" t-out="state.data.order.active"/>
                        <div class="kpi-sub">ƒë∆°n h√†ng</div>
                    </div>

                    <div class="gmd-kpi-card kpi-danger"
                         t-on-click="() => this.openAction('garment_base.action_garment_order')">
                        <div class="kpi-label">ƒê∆°n Tr·ªÖ H·∫°n</div>
                        <div class="kpi-number" t-out="state.data.order.late"/>
                        <div class="kpi-sub">c·∫ßn x·ª≠ l√Ω</div>
                    </div>

                    <div class="gmd-kpi-card kpi-success">
                        <div class="kpi-label">T·ªâ L·ªá ƒê·∫°t QC</div>
                        <div class="kpi-number">
                            <t t-out="state.data.quality.pass_rate"/>%
                        </div>
                        <div class="kpi-sub">
                            <t t-out="state.data.quality.total"/> ki·ªÉm tra
                        </div>
                    </div>

                    <div class="gmd-kpi-card kpi-purple">
                        <div class="kpi-label">SX ƒêang Ch·∫°y</div>
                        <div class="kpi-number" t-out="state.data.production.active"/>
                        <div class="kpi-sub">
                            <t t-out="state.data.production.done"/> ho√†n th√†nh
                        </div>
                    </div>

                    <div class="gmd-kpi-card kpi-warning">
                        <div class="kpi-label">Ch·ªù Duy·ªát</div>
                        <div class="kpi-number" t-out="state.data.pending_approvals"/>
                        <div class="kpi-sub">ƒë∆°n h√†ng</div>
                    </div>
                </div>

                <!-- Production Progress -->
                <div class="gmd-progress-section">
                    <div class="gmd-progress-header">
                        <h4>üìà Ti·∫øn ƒê·ªô S·∫£n Xu·∫•t</h4>
                        <span class="kpi-sub">
                            <t t-out="state.data.production.completion_pct"/>%
                        </span>
                    </div>
                    <div class="gmd-progress-bar-container">
                        <div class="gmd-progress-bar-fill"
                             t-attf-style="width: {{ state.data.production.completion_pct }}%"/>
                    </div>
                    <div class="gmd-progress-stats">
                        <span>
                            ƒê√£ ho√†n th√†nh: <t t-out="state.data.production.completed_qty"/>
                        </span>
                        <span>
                            T·ªïng k·∫ø ho·∫°ch: <t t-out="state.data.production.planned_qty"/>
                        </span>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="gmd-quick-actions">
                    <button class="gmd-action-btn"
                            t-on-click="() => this.openAction('garment_base.action_garment_order')">
                        <span class="action-icon">üìã</span>
                        <span class="action-label">ƒê∆°n H√†ng</span>
                    </button>
                    <button class="gmd-action-btn"
                            t-on-click="() => this.openAction('garment_production.action_production_order')">
                        <span class="action-icon">üè≠</span>
                        <span class="action-label">S·∫£n Xu·∫•t</span>
                    </button>
                    <button class="gmd-action-btn"
                            t-on-click="() => this.openAction('garment_quality.action_qc_inspection')">
                        <span class="action-icon">‚úÖ</span>
                        <span class="action-label">Ki·ªÉm QC</span>
                    </button>
                    <button class="gmd-action-btn"
                            t-on-click="() => this.openAction('garment_delivery.action_delivery_order')">
                        <span class="action-icon">üöö</span>
                        <span class="action-label">Giao H√†ng</span>
                    </button>
                    <button class="gmd-action-btn"
                            t-on-click="() => this.openAction('garment_inventory.action_fabric_inventory')">
                        <span class="action-icon">üì¶</span>
                        <span class="action-label">Kho</span>
                    </button>
                    <button class="gmd-action-btn"
                            t-on-click="() => this.openAction('garment_hr.action_garment_employee')">
                        <span class="action-icon">üë∑</span>
                        <span class="action-label">Nh√¢n S·ª±</span>
                    </button>
                    <button class="gmd-action-btn"
                            t-on-click="() => this.openAction('garment_packing.action_packing_order')">
                        <span class="action-icon">üì¶</span>
                        <span class="action-label">ƒê√≥ng G√≥i</span>
                    </button>
                    <button class="gmd-action-btn"
                            t-on-click="() => this.openDashboard()">
                        <span class="action-icon">üìä</span>
                        <span class="action-label">Dashboard</span>
                    </button>
                </div>

                <!-- Late Orders Alert -->
                <div t-if="state.data.late.length > 0" class="gmd-alert-section">
                    <div class="gmd-alert-header danger">
                        üö® ƒê∆°n H√†ng Tr·ªÖ H·∫°n
                    </div>
                    <div t-foreach="state.data.late" t-as="item" t-key="item.name"
                         class="gmd-alert-item"
                         t-on-click="() => this.openOrder(item.name)">
                        <div class="item-left">
                            <div class="item-name" t-out="item.name"/>
                            <div class="item-detail" t-out="item.customer"/>
                        </div>
                        <span class="item-badge badge-danger">
                            Tr·ªÖ <t t-out="item.days_late"/> ng√†y
                        </span>
                    </div>
                </div>

                <!-- Upcoming Deliveries -->
                <div t-if="state.data.upcoming.length > 0" class="gmd-alert-section">
                    <div class="gmd-alert-header warning">
                        üìÖ Giao H√†ng S·∫Øp T·ªõi (3 Ng√†y)
                    </div>
                    <div t-foreach="state.data.upcoming" t-as="item" t-key="item.name"
                         class="gmd-alert-item"
                         t-on-click="() => this.openOrder(item.name)">
                        <div class="item-left">
                            <div class="item-name" t-out="item.name"/>
                            <div class="item-detail" t-out="item.customer"/>
                        </div>
                        <span class="item-badge badge-warning">
                            <t t-if="item.days === 0">H√¥m nay</t>
                            <t t-elif="item.days === 1">Ng√†y mai</t>
                            <t t-else="">C√≤n <t t-out="item.days"/> ng√†y</t>
                        </span>
                    </div>
                </div>

                <!-- Delivery Stats -->
                <div class="gmd-progress-section">
                    <div class="gmd-progress-header">
                        <h4>üöö T√¨nh Tr·∫°ng Giao H√†ng</h4>
                    </div>
                    <div class="gmd-kpi-grid" style="margin-bottom: 0;">
                        <div class="gmd-kpi-card kpi-warning" style="border-left-width: 3px;">
                            <div class="kpi-label">Ch·ªù Giao</div>
                            <div class="kpi-number" t-out="state.data.delivery.pending"/>
                        </div>
                        <div class="gmd-kpi-card kpi-success" style="border-left-width: 3px;">
                            <div class="kpi-label">ƒê√£ Giao</div>
                            <div class="kpi-number" t-out="state.data.delivery.done"/>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </t>

</templates>
